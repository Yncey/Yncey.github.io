<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Explain执行计划 | Yasir'S Blog</title><meta name="author" content="Yasir"><meta name="copyright" content="Yasir"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Explain执行计划1.Explain有什么用  当Explain与SQL一起执行时，MySQL会显示来自优化器关于SQL执行的信息。MySQL解释了他将如何处理该语句，包括如何连接表以及什么顺序连接表等。  表的加载顺序  sql的查询类型  可能用到哪些索引，哪些索引又被实际使用  表与表之间的引用关系  一个表中有多少行被优化器查询…   2.Explain有哪些信息Explain执行计划">
<meta property="og:type" content="article">
<meta property="og:title" content="Explain执行计划">
<meta property="og:url" content="http://example.com/2020/11/13/Explain%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/index.html">
<meta property="og:site_name" content="Yasir&#39;S Blog">
<meta property="og:description" content="Explain执行计划1.Explain有什么用  当Explain与SQL一起执行时，MySQL会显示来自优化器关于SQL执行的信息。MySQL解释了他将如何处理该语句，包括如何连接表以及什么顺序连接表等。  表的加载顺序  sql的查询类型  可能用到哪些索引，哪些索引又被实际使用  表与表之间的引用关系  一个表中有多少行被优化器查询…   2.Explain有哪些信息Explain执行计划">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2019/11/10/egVhFWopA5mP2Hk.png">
<meta property="article:published_time" content="2020-11-13T07:09:46.000Z">
<meta property="article:modified_time" content="2020-12-09T06:19:24.351Z">
<meta property="article:author" content="Yasir">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2019/11/10/egVhFWopA5mP2Hk.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2020/11/13/Explain%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="yandex-verification" content="{&quot;theme_color&quot;:{&quot;enable&quot;:true,&quot;main&quot;:&quot;#F2F2F2&quot;,&quot;paginator&quot;:&quot;#00c4b6&quot;,&quot;button_hover&quot;:&quot;#FF7242&quot;,&quot;text_selection&quot;:&quot;#00c4b6&quot;,&quot;link_color&quot;:&quot;#99a9bf&quot;,&quot;meta_color&quot;:&quot;#858585&quot;,&quot;hr_color&quot;:&quot;#A4D8FA&quot;,&quot;code_foreground&quot;:&quot;#F47466&quot;,&quot;code_background&quot;:&quot;rgba(27, 31, 35, .05)&quot;,&quot;toc_color&quot;:&quot;#00c4b6&quot;,&quot;blockquote_padding_color&quot;:&quot;#F2F2F2&quot;,&quot;blockquote_background_color&quot;:&quot;#F2F2F2&quot;}}"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":false,"highlightLang":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-12-09 14:19:24'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Yasir'S Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://i.loli.net/2020/11/04/NOYMJbKtxVSUy5T.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">27</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/study/"><i class="fa-fw fas fa-book-open"></i><span> 文库</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-download"></i><span> 资源中心</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/activate/"><i class="fa-fw fas fa-folder-open"></i><span> 激活</span></a></li><li><a class="site-page" href="/categories/mac/"><i class="fa-fw fas fa-folder-open"></i><span> Mac</span></a></li><li><a class="site-page" href="/categories/windows/"><i class="fa-fw fas fa-folder-open"></i><span> Windows</span></a></li></ul></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2019/11/10/egVhFWopA5mP2Hk.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Yasir'S Blog</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/study/"><i class="fa-fw fas fa-book-open"></i><span> 文库</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-download"></i><span> 资源中心</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/activate/"><i class="fa-fw fas fa-folder-open"></i><span> 激活</span></a></li><li><a class="site-page" href="/categories/mac/"><i class="fa-fw fas fa-folder-open"></i><span> Mac</span></a></li><li><a class="site-page" href="/categories/windows/"><i class="fa-fw fas fa-folder-open"></i><span> Windows</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">Explain执行计划</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-13T07:09:46.000Z" title="发表于 2020-11-13 15:09:46">2020-11-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-12-09T06:19:24.351Z" title="更新于 2020-12-09 14:19:24">2020-12-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/study/">study</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Explain执行计划"><a href="#Explain执行计划" class="headerlink" title="Explain执行计划"></a>Explain执行计划</h2><h3 id="1-Explain有什么用"><a href="#1-Explain有什么用" class="headerlink" title="1.Explain有什么用"></a>1.Explain有什么用</h3><p>  当Explain与SQL一起执行时，MySQL会显示来自优化器关于SQL执行的信息。MySQL解释了他将如何处理该语句，包括如何连接表以及什么顺序连接表等。</p>
<ul>
<li><p>表的加载顺序</p>
</li>
<li><p>sql的查询类型</p>
</li>
<li><p>可能用到哪些索引，哪些索引又被实际使用</p>
</li>
<li><p>表与表之间的引用关系</p>
</li>
<li><p>一个表中有多少行被优化器查询…</p>
</li>
</ul>
<h3 id="2-Explain有哪些信息"><a href="#2-Explain有哪些信息" class="headerlink" title="2.Explain有哪些信息"></a>2.Explain有哪些信息</h3><p>Explain执行计划包含字段信息如下：分别是<code>id</code>、<code>select_type</code>、<code>table</code>、<code>partitions</code>、<code>type</code>、<code>possible_keys</code>、<code>key</code>、<code>key_len</code>、<code>ref</code>、<code>rows</code>、<code>filtered</code>、<code>Extra</code> 12个字段。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br></pre></td></tr></table></figure>

<h3 id="3-Explain执行计划详解"><a href="#3-Explain执行计划详解" class="headerlink" title="3.Explain执行计划详解"></a>3.Explain执行计划详解</h3><h4 id="3-1-id"><a href="#3-1-id" class="headerlink" title="3.1 id"></a>3.1 id</h4><p><code>id</code> :表示查询中执行select子句或者操作表的顺序。<code>id</code><strong>值越大，优先级越高，越先执行。</strong><code>id</code>大致会出现3种情况</p>
<h5 id="1、id相同"><a href="#1、id相同" class="headerlink" title="1、id相同"></a>1、<code>id</code>相同</h5><p>看到三条记录的<code>id</code>都相同，可以理解成这三个表为一组，具有同样的优先级，执行顺序由上而下，具体顺序由优化器决定。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT * FROM one o,two t, three r WHERE o.two_id = t.two_id AND t.three_id = r.three_id;</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+----------------------+------+----------+----------------------------------------------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type   |</span> possible_keys <span class="params">| key     |</span> key_len <span class="params">| ref                  |</span> rows <span class="params">| filtered |</span> Extra                                              <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+--------+---------------+---------+---------+----------------------+------+----------+----------------------------------------------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> o     <span class="params">| NULL       |</span> ALL    <span class="params">| NULL          |</span> NULL    <span class="params">| NULL    |</span> NULL                 <span class="params">|    2 |</span>      <span class="number">100</span> <span class="params">| NULL                                               |</span></span><br><span class="line"><span class="params">|  1 |</span> SIMPLE      <span class="params">| t     |</span> NULL       <span class="params">| ALL    |</span> PRIMARY       <span class="params">| NULL    |</span> NULL    <span class="params">| NULL                 |</span>    <span class="number">2</span> <span class="params">|       50 |</span> Using where; Using join buffer (Block Nested Loop) <span class="params">|</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> r     <span class="params">| NULL       |</span> eq_ref <span class="params">| PRIMARY       |</span> PRIMARY <span class="params">| 4       |</span> xin-slave.t.three_id <span class="params">|    1 |</span>      <span class="number">100</span> <span class="params">| NULL                                               |</span></span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+----------------------+------+----------+----------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h5 id="2、id不同"><a href="#2、id不同" class="headerlink" title="2、id不同"></a>2、<code>id</code>不同</h5><p>如果我们的 <code>SQL</code> 中存在子查询，那么 <code>id</code>的序号会递增，<code>id</code>值越大优先级越高，越先被执行 。当三个表依次嵌套，发现最里层的子查询 <code>id</code>最大，最先执行。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN select * from one o where o.two_id = (select t.two_id from two t where t.three_id = (select r.three_id  from three r where r.three_name=<span class="string">&#x27;我是第三表2&#x27;</span>));</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| PRIMARY     |</span> o     <span class="params">| NULL       |</span> ALL  <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    2 |</span>       <span class="number">50</span> <span class="params">| Using where |</span></span><br><span class="line"><span class="params">|  2 |</span> SUBQUERY    <span class="params">| t     |</span> NULL       <span class="params">| ALL  |</span> NULL          <span class="params">| NULL |</span> NULL    <span class="params">| NULL |</span>    <span class="number">2</span> <span class="params">|       50 |</span> Using where <span class="params">|</span></span><br><span class="line"><span class="params">|</span>  <span class="number">3</span> <span class="params">| SUBQUERY    |</span> r     <span class="params">| NULL       |</span> ALL  <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    2 |</span>       <span class="number">50</span> <span class="params">| Using where |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br></pre></td></tr></table></figure>

<h5 id="3、以上两种同时存在"><a href="#3、以上两种同时存在" class="headerlink" title="3、以上两种同时存在"></a>3、以上两种同时存在</h5><p>将上边的 <code>SQL</code> 稍微修改一下，增加一个子查询，发现 <code>id</code>的以上两种同时存在。相同<code>id</code>划分为一组，这样就有三个组，同组的从上往下顺序执行，不同组 <code>id</code>值越大，优先级越高，越先执行。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;  EXPLAIN select * from one o where o.two_id = (select t.two_id from two t where t.three_id = (select r.three_id  from three r where r.three_name=<span class="string">&#x27;我是第三表2&#x27;</span>)) AND o.one_id <span class="keyword">in</span>(select one_id from one where o.one_name=<span class="string">&quot;我是第一表2&quot;</span>);</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+--------------------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type   |</span> possible_keys <span class="params">| key     |</span> key_len <span class="params">| ref                |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+--------+---------------+---------+---------+--------------------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| PRIMARY     |</span> o     <span class="params">| NULL       |</span> ALL    <span class="params">| PRIMARY       |</span> NULL    <span class="params">| NULL    |</span> NULL               <span class="params">|    2 |</span>       <span class="number">50</span> <span class="params">| Using where |</span></span><br><span class="line"><span class="params">|  1 |</span> PRIMARY     <span class="params">| one   |</span> NULL       <span class="params">| eq_ref |</span> PRIMARY       <span class="params">| PRIMARY |</span> <span class="number">4</span>       <span class="params">| xin-slave.o.one_id |</span>    <span class="number">1</span> <span class="params">|      100 |</span> Using index <span class="params">|</span></span><br><span class="line"><span class="params">|</span>  <span class="number">2</span> <span class="params">| SUBQUERY    |</span> t     <span class="params">| NULL       |</span> ALL    <span class="params">| NULL          |</span> NULL    <span class="params">| NULL    |</span> NULL               <span class="params">|    2 |</span>       <span class="number">50</span> <span class="params">| Using where |</span></span><br><span class="line"><span class="params">|  3 |</span> SUBQUERY    <span class="params">| r     |</span> NULL       <span class="params">| ALL    |</span> NULL          <span class="params">| NULL    |</span> NULL    <span class="params">| NULL               |</span>    <span class="number">2</span> <span class="params">|       50 |</span> Using where <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+--------+---------------+---------+---------+--------------------+------+----------+-------------+</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2select-type"><a href="#3-2select-type" class="headerlink" title="3.2select_type"></a>3.2select_type</h4><p><code>select_type</code>：表示 <code>select</code> 查询的类型，主要是用于区分各种复杂的查询，例如：<code>普通查询</code>、<code>联合查询</code>、<code>子查询</code>等。</p>
<h5 id="1、SIMPLE"><a href="#1、SIMPLE" class="headerlink" title="1、SIMPLE"></a>1、SIMPLE</h5><p><code>SIMPLE</code>：表示最简单的 select 查询语句，也就是在查询中不包含子查询或者 <code>union</code>交并差集等操作。</p>
<h5 id="2、PRIMARY"><a href="#2、PRIMARY" class="headerlink" title="2、PRIMARY"></a>2、PRIMARY</h5><p><code>PRIMARY</code>：当查询语句中包含任何复杂的子部分，最外层查询则被标记为<code>PRIMARY</code>。</p>
<h5 id="3、SUBQUERY"><a href="#3、SUBQUERY" class="headerlink" title="3、SUBQUERY"></a>3、SUBQUERY</h5><p><code>SUBQUERY</code>：当 <code>select</code> 或 <code>where</code> 列表中包含了子查询，该子查询被标记为：<code>SUBQUERY</code> 。</p>
<h5 id="4、DERIVED"><a href="#4、DERIVED" class="headerlink" title="4、DERIVED"></a>4、DERIVED</h5><p><code>DERIVED</code>：表示包含在<code>from</code>子句中的子查询的select，在我们的 <code>from</code> 列表中包含的子查询会被标记为<code>derived</code> 。</p>
<h5 id="5、UNION"><a href="#5、UNION" class="headerlink" title="5、UNION"></a>5、UNION</h5><p><code>UNION</code>：如果<code>union</code>后边又出现的<code>select</code> 语句，则会被标记为<code>union</code>；若 <code>union</code> 包含在 <code>from</code> 子句的子查询中，外层 <code>select</code> 将被标记为 <code>derived</code>。</p>
<h5 id="6、UNION-RESULT"><a href="#6、UNION-RESULT" class="headerlink" title="6、UNION RESULT"></a>6、UNION RESULT</h5><p><code>UNION RESULT</code>：代表从<code>union</code>的临时表中读取数据，而<code>table</code>列的<code>&lt;union1,4&gt;</code>表示用第一个和第四个<code>select</code>的结果进行<code>union</code>操作。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN select t.two_name, ( select one.one_id from one) o from (select two_id,two_name from two where two_name =<span class="string">&#x27;&#x27;</span>) t  union (select r.three_name,r.three_id from three r);</span><br><span class="line"></span><br><span class="line">+------+--------------+------------+------------+-------+---------------+---------+---------+------+------+----------+-----------------+</span><br><span class="line"><span class="params">| id   |</span> select_type  <span class="params">| table      |</span> partitions <span class="params">| type  |</span> possible_keys <span class="params">| key     |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra           <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------------+------------+------------+-------+---------------+---------+---------+------+------+----------+-----------------+</span></span><br><span class="line"><span class="params">|</span>    <span class="number">1</span> <span class="params">| PRIMARY      |</span> two        <span class="params">| NULL       |</span> ALL   <span class="params">| NULL          |</span> NULL    <span class="params">| NULL    |</span> NULL <span class="params">|    2 |</span>       <span class="number">50</span> <span class="params">| Using where     |</span></span><br><span class="line"><span class="params">|    2 |</span> SUBQUERY     <span class="params">| one        |</span> NULL       <span class="params">| index |</span> NULL          <span class="params">| PRIMARY |</span> <span class="number">4</span>       <span class="params">| NULL |</span>    <span class="number">2</span> <span class="params">|      100 |</span> Using index     <span class="params">|</span></span><br><span class="line"><span class="params">|</span>    <span class="number">4</span> <span class="params">| UNION        |</span> r          <span class="params">| NULL       |</span> ALL   <span class="params">| NULL          |</span> NULL    <span class="params">| NULL    |</span> NULL <span class="params">|    2 |</span>      <span class="number">100</span> <span class="params">| NULL            |</span></span><br><span class="line"><span class="params">| NULL |</span> UNION RESULT <span class="params">| &lt;union1,4&gt; |</span> NULL       <span class="params">| ALL   |</span> NULL          <span class="params">| NULL    |</span> NULL    <span class="params">| NULL |</span> NULL <span class="params">| NULL     |</span> Using temporary <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------------+------------+------------+-------+---------------+---------+---------+------+------+----------+-----------------+</span></span><br></pre></td></tr></table></figure>

<h4 id="3-3table"><a href="#3-3table" class="headerlink" title="3.3table"></a>3.3table</h4><p>查询的表名，并不一定是真实存在的表，有别名显示别名，也可能为临时表，例如上边的<code>DERIVED</code>、 <code>&lt;union1,4&gt;</code>等。</p>
<h4 id="3-4partitions"><a href="#3-4partitions" class="headerlink" title="3.4partitions"></a>3.4partitions</h4><p>查询时匹配到的分区信息，对于非分区表值为<code>NULL</code>，当查询的是分区表时，<code>partitions</code>显示分区表命中的分区情况。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+----+-------------+----------------+---------------------------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table          |</span> partitions                      <span class="params">| type  |</span> possible_keys <span class="params">| key     |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+----------------+---------------------------------+-------+---------------+---------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> one            <span class="params">| p201801,p201802,p201803,p300012 |</span> index <span class="params">| NULL          |</span> PRIMARY <span class="params">| 9       |</span> NULL <span class="params">|    3 |</span>      <span class="number">100</span> <span class="params">| Using index |</span></span><br><span class="line">+----+-------------+----------------+---------------------------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br></pre></td></tr></table></figure>

<h4 id="3-5type"><a href="#3-5type" class="headerlink" title="3.5type"></a>3.5type</h4><p><code>type</code>：查询使用了何种类型，它在 <code>SQL</code>优化中是一个非常重要的指标，以下性能从好到坏依次是：<code>system</code> &gt; <code>const</code> &gt; <code>eq_ref</code> &gt; <code>ref</code> &gt; <code>ref_or_null</code> &gt; <code>index_merge</code> &gt; <code>unique_subquery</code> &gt; <code>index_subquery</code> &gt; <code>range</code> &gt; <code>index</code> &gt; <code>ALL</code></p>
<h5 id="1、system"><a href="#1、system" class="headerlink" title="1、system"></a>1、system</h5><p><code>system</code>：当表仅有一行记录时(系统表)，数据量很少，往往不需要进行磁盘IO，速度非常快。</p>
<h5 id="2、const"><a href="#2、const" class="headerlink" title="2、const"></a>2、const</h5><p><code>const</code>：表示查询时命中 <code>primary key</code> 主键或者 <code>unique</code> 唯一索引，或者被连接的部分是一个常量(<code>const</code>)值。这类扫描效率极高，返回数据量少，速度非常快。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT * from three where three_id=<span class="number">1</span>;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type  |</span> possible_keys <span class="params">| key     |</span> key_len <span class="params">| ref   |</span> rows <span class="params">| filtered |</span> Extra <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> three <span class="params">| NULL       |</span> const <span class="params">| PRIMARY       |</span> PRIMARY <span class="params">| 4       |</span> const <span class="params">|    1 |</span>      <span class="number">100</span> <span class="params">| NULL  |</span></span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+</span><br></pre></td></tr></table></figure>

<h5 id="3、eq-ref"><a href="#3、eq-ref" class="headerlink" title="3、eq_ref"></a>3、eq_ref</h5><p><code>eq_ref</code>：查询时命中主键<code>primary key</code> 或者 <code>unique key</code>索引， <code>type</code> 就是 <code>eq_ref</code>。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN select o.one_name from one o ,two t where o.one_id = t.two_id ; </span><br><span class="line">+----+-------------+-------+------------+--------+---------------+----------+---------+--------------------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type   |</span> possible_keys <span class="params">| key      |</span> key_len <span class="params">| ref                |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+--------+---------------+----------+---------+--------------------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> o     <span class="params">| NULL       |</span> index  <span class="params">| PRIMARY       |</span> idx_name <span class="params">| 768     |</span> NULL               <span class="params">|    2 |</span>      <span class="number">100</span> <span class="params">| Using index |</span></span><br><span class="line"><span class="params">|  1 |</span> SIMPLE      <span class="params">| t     |</span> NULL       <span class="params">| eq_ref |</span> PRIMARY       <span class="params">| PRIMARY  |</span> <span class="number">4</span>       <span class="params">| xin-slave.o.one_id |</span>    <span class="number">1</span> <span class="params">|      100 |</span> Using index <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+--------+---------------+----------+---------+--------------------+------+----------+-------------+</span></span><br></pre></td></tr></table></figure>

<h5 id="4、ref"><a href="#4、ref" class="headerlink" title="4、ref"></a>4、ref</h5><p><code>ref</code>：区别于<code>eq_ref</code> ，<code>ref</code>表示使用非唯一性索引，会找到很多个符合条件的行。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select o.one_id from one o where o.one_name = <span class="string">&quot;xin&quot;</span> ; </span><br><span class="line">+--------+</span><br><span class="line"><span class="params">| one_id |</span></span><br><span class="line">+--------+</span><br><span class="line"><span class="params">|      1 |</span></span><br><span class="line"><span class="params">|      3 |</span></span><br><span class="line">+--------+</span><br></pre></td></tr></table></figure>


<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN select o.one_id from one o where o.one_name = &quot;xin&quot; ; </span><br><span class="line">+<span class="comment">----+-------------+-------+------------+------+---------------+----------+---------+-------+------+----------+-------------+</span></span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key      | key_len | ref   | rows | filtered | Extra       |</span><br><span class="line">+<span class="comment">----+-------------+-------+------------+------+---------------+----------+---------+-------+------+----------+-------------+</span></span><br><span class="line">|  1 | SIMPLE      | o     | NULL       | ref  | idx_name      | idx_name | 768     | const |    1 |      100 | Using index |</span><br><span class="line">+<span class="comment">----+-------------+-------+------------+------+---------------+----------+---------+-------+------+----------+-------------+</span></span><br></pre></td></tr></table></figure>

<h5 id="5、ref-or-null"><a href="#5、ref-or-null" class="headerlink" title="5、ref_or_null"></a>5、ref_or_null</h5><p><code>ref_or_null</code>：这种连接类型类似于 ref，区别在于 <code>MySQL</code>会额外搜索包含<code>NULL</code>值的行。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN select o.one_id from one o where o.one_name = <span class="string">&quot;xin&quot;</span> OR o.one_name IS NULL; </span><br><span class="line">+----+-------------+-------+------------+-------------+---------------+----------+---------+-------+------+----------+--------------------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type        |</span> possible_keys <span class="params">| key      |</span> key_len <span class="params">| ref   |</span> rows <span class="params">| filtered |</span> Extra                    <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+-------------+---------------+----------+---------+-------+------+----------+--------------------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> o     <span class="params">| NULL       |</span> ref_or_null <span class="params">| idx_name      |</span> idx_name <span class="params">| 768     |</span> const <span class="params">|    3 |</span>      <span class="number">100</span> <span class="params">| Using where; Using index |</span></span><br><span class="line">+----+-------------+-------+------------+-------------+---------------+----------+---------+-------+------+----------+--------------------------+</span><br></pre></td></tr></table></figure>

<h5 id="6、index-merge"><a href="#6、index-merge" class="headerlink" title="6、index_merge"></a>6、index_merge</h5><p><code>index_merge</code>：使用了索引合并优化方法，查询使用了两个以上的索引。</p>
<p>下边示例中同时使用到主键<code>one_id</code> 和 字段<code>one_name</code>的<code>idx_name</code> 索引 。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN select * from one o where o.one_id &gt;<span class="number">1</span> <span class="keyword">and</span> o.one_name =<span class="string">&#x27;xin&#x27;</span>; </span><br><span class="line">+----+-------------+-------+------------+-------------+------------------+------------------+---------+------+------+----------+------------------------------------------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type        |</span> possible_keys    <span class="params">| key              |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra                                          <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+-------------+------------------+------------------+---------+------+------+----------+------------------------------------------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> o     <span class="params">| NULL       |</span> index_merge <span class="params">| PRIMARY,idx_name |</span> idx_name,PRIMARY <span class="params">| 772,4   |</span> NULL <span class="params">|    1 |</span>      <span class="number">100</span> <span class="params">| Using intersect(idx_name,PRIMARY); Using where |</span></span><br><span class="line">+----+-------------+-------+------------+-------------+------------------+------------------+---------+------+------+----------+------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h5 id="7、unique-subquery"><a href="#7、unique-subquery" class="headerlink" title="7、unique_subquery"></a>7、unique_subquery</h5><p><code>unique_subquery</code>：替换下面的 <code>IN</code>子查询，子查询返回不重复的集合。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">value</span> <span class="title">IN</span> (<span class="params">SELECT primary_key FROM single_table WHERE some_expr</span>)</span></span><br></pre></td></tr></table></figure>

<h5 id="8、index-subquery"><a href="#8、index-subquery" class="headerlink" title="8、index_subquery"></a>8、index_subquery</h5><p><code>index_subquery</code>：区别于<code>unique_subquery</code>，用于非唯一索引，可以返回重复值。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">value</span> <span class="title">IN</span> (<span class="params">SELECT key_column FROM single_table WHERE some_expr</span>)</span></span><br></pre></td></tr></table></figure>

<h5 id="9、range"><a href="#9、range" class="headerlink" title="9、range"></a>9、range</h5><p><code>range</code>：使用索引选择行，仅检索给定范围内的行。简单点说就是针对一个有索引的字段，给定范围检索数据。在<code>where</code>语句中使用 <code>bettween...and</code>、<code>&lt;</code>、<code>&gt;</code>、<code>&lt;=</code>、<code>in</code> 等条件查询 <code>type</code> 都是 <code>range</code>。</p>
<p>举个栗子：<code>three</code>表中<code>three_id</code>为唯一主键，<code>user_id</code>普通字段未建索引。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT * from three where three_id BETWEEN <span class="number">2</span> AND <span class="number">3</span>;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type  |</span> possible_keys <span class="params">| key     |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> three <span class="params">| NULL       |</span> range <span class="params">| PRIMARY       |</span> PRIMARY <span class="params">| 4       |</span> NULL <span class="params">|    1 |</span>      <span class="number">100</span> <span class="params">| Using where |</span></span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br></pre></td></tr></table></figure>

<p>从结果中看到只有对设置了索引的字段，做范围检索 <code>type</code> 才是 <code>range</code>。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT * from three where user_id BETWEEN <span class="number">2</span> AND <span class="number">3</span>;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> three <span class="params">| NULL       |</span> ALL  <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    3 |</span>    <span class="number">33.33</span> <span class="params">| Using where |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br></pre></td></tr></table></figure>

<h5 id="10、index"><a href="#10、index" class="headerlink" title="10、index"></a>10、index</h5><p><code>index</code>：<code>Index</code> 与<code>ALL</code> 其实都是读全表，区别在于<code>index</code>是遍历索引树读取，而<code>ALL</code>是从硬盘中读取。</p>
<p>下边示例：<code>three_id</code> 为主键，不带 <code>where</code> 条件全表查询 ，<code>type</code>结果为<code>index</code> 。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT three_id from three ;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type  |</span> possible_keys <span class="params">| key     |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> three <span class="params">| NULL       |</span> index <span class="params">| NULL          |</span> PRIMARY <span class="params">| 4       |</span> NULL <span class="params">|    1 |</span>      <span class="number">100</span> <span class="params">| Using index |</span></span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br></pre></td></tr></table></figure>

<h5 id="11、ALL"><a href="#11、ALL" class="headerlink" title="11、ALL"></a>11、ALL</h5><p><code>ALL</code>：将遍历全表以找到匹配的行，性能最差。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT * from two ;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> two   <span class="params">| NULL       |</span> ALL  <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    2 |</span>      <span class="number">100</span> <span class="params">| NULL  |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br></pre></td></tr></table></figure>

<h4 id="3-6possible-keys"><a href="#3-6possible-keys" class="headerlink" title="3.6possible_keys"></a>3.6possible_keys</h4><p><code>possible_keys</code>：表示在<code>MySQL</code>中通过哪些索引，能让我们在表中找到想要的记录，一旦查询涉及到的某个字段上存在索引，则索引将被列出，<strong>但这个索引并不定一会是最终查询数据时所被用到的索引</strong>。具体请参考上边的例子。</p>
<h4 id="3-7key"><a href="#3-7key" class="headerlink" title="3.7key"></a>3.7key</h4><p><code>key</code>：区别于<code>possible_keys</code>，key是查询中实际使用到的索引，若没有使用索引，显示为<code>NULL</code>。具体请参考上边的例子。</p>
<blockquote>
<p>当 <code>type</code> 为 <code>index_merge</code> 时，可能会显示多个索引。</p>
</blockquote>
<h4 id="3-8key-len"><a href="#3-8key-len" class="headerlink" title="3.8key_len"></a>3.8key_len</h4><p><code>key_len</code>：表示查询用到的索引长度（字节数），原则上长度越短越好 。</p>
<ul>
<li>单列索引，那么需要将整个索引长度算进去；</li>
<li>多列索引，不是所有列都能用到，需要计算查询中实际用到的列。</li>
</ul>
<blockquote>
<p>注意：<code>key_len</code>只计算<code>where</code>条件中用到的索引长度，而排序和分组即便是用到了索引，也不会计算到<code>key_len</code>中。</p>
</blockquote>
<h4 id="3-9ref"><a href="#3-9ref" class="headerlink" title="3.9ref"></a>3.9ref</h4><p><code>ref</code>：常见的有：<code>const</code>，<code>func</code>，<code>null</code>，字段名。</p>
<ul>
<li>当使用常量等值查询，显示<code>const</code>，</li>
<li>当关联查询时，会显示相应关联表的<code>关联字段</code></li>
<li>如果查询条件使用了<code>表达式</code>、<code>函数</code>，或者条件列发生内部隐式转换，可能显示为<code>func</code></li>
<li>其他情况<code>null</code></li>
</ul>
<h4 id="3-10rows"><a href="#3-10rows" class="headerlink" title="3.10rows"></a>3.10rows</h4><p><code>rows</code>：以表的统计信息和索引使用情况，估算要找到我们所需的记录，需要读取的行数。</p>
<p>这是评估<code>SQL</code> 性能的一个比较重要的数据，<code>mysql</code>需要扫描的行数，很直观的显示 <code>SQL</code> 性能的好坏，一般情况下 <code>rows</code> 值越小越好。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT * from three;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> three <span class="params">| NULL       |</span> ALL  <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    3 |</span>      <span class="number">100</span> <span class="params">| NULL  |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br></pre></td></tr></table></figure>

<h4 id="3-11filtered"><a href="#3-11filtered" class="headerlink" title="3.11filtered"></a>3.11filtered</h4><p><code>filtered</code> 这个是一个百分比的值，表里符合条件的记录数的百分比。简单点说，这个字段表示存储引擎返回的数据在经过过滤后，剩下满足条件的记录数量的比例。</p>
<p>在<code>MySQL.5.7</code>版本以前想要显示<code>filtered</code>需要使用<code>explain extended</code>命令。<code>MySQL.5.7</code>后，默认<code>explain</code>直接显示<code>partitions</code>和<code>filtered</code>的信息。</p>
<h4 id="3-12Extra"><a href="#3-12Extra" class="headerlink" title="3.12Extra"></a>3.12Extra</h4><p><code>Extra</code> ：不适合在其他列中显示的信息，<code>Explain</code> 中的很多额外的信息会在 <code>Extra</code> 字段显示。</p>
<h5 id="1、Using-index"><a href="#1、Using-index" class="headerlink" title="1、Using index"></a>1、Using index</h5><p><code>Using index</code>：我们在相应的 <code>select</code> 操作中使用了覆盖索引，通俗一点讲就是查询的列被索引覆盖，使用到覆盖索引查询速度会非常快，<code>SQl</code>优化中理想的状态。</p>
<p>什么又是覆盖索引?</p>
<p>一条 <code>SQL</code>只需要通过索引就可以返回，我们所需要查询的数据（一个或几个字段），而不必通过二级索引，查到主键之后再通过主键查询整行数据（<code>select *</code> ）。</p>
<p><code>one_id</code>表为主键</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT one_id from one ;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type  |</span> possible_keys <span class="params">| key        |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+-------+---------------+------------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> one   <span class="params">| NULL       |</span> index <span class="params">| NULL          |</span> idx_two_id <span class="params">| 5       |</span> NULL <span class="params">|    3 |</span>      <span class="number">100</span> <span class="params">| Using index |</span></span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------------+---------+------+------+----------+-------------+</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：想要使用到覆盖索引，我们在 <code>select</code> 时只取出需要的字段，不可<code>select *</code>，而且该字段建了索引。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT * from one ;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> one   <span class="params">| NULL       |</span> ALL  <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    3 |</span>      <span class="number">100</span> <span class="params">| NULL  |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br></pre></td></tr></table></figure>

<h5 id="2、Using-where"><a href="#2、Using-where" class="headerlink" title="2、Using where"></a>2、Using where</h5><p><code>Using where</code>：查询时未找到可用的索引，进而通过<code>where</code>条件过滤获取所需数据，但要注意的是并不是所有带<code>where</code>语句的查询都会显示<code>Using where</code>。</p>
<p>下边示例<code>create_time</code> 并未用到索引，<code>type</code> 为 <code>ALL</code>，即<code>MySQL</code>通过全表扫描后再按<code>where</code>条件筛选数据。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT one_name from one where create_time =<span class="string">&#x27;2020-05-18&#x27;</span>;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> one   <span class="params">| NULL       |</span> ALL  <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    3 |</span>    <span class="number">33.33</span> <span class="params">| Using where |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br></pre></td></tr></table></figure>

<h5 id="3、Using-temporary"><a href="#3、Using-temporary" class="headerlink" title="3、Using temporary"></a>3、Using temporary</h5><p><code>Using temporary</code>：表示查询后结果需要使用临时表来存储，一般在排序或者分组查询时用到。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT one_name from one where one_id <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">2</span>) group by one_name;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> one   <span class="params">| NULL       |</span> range<span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    3 |</span>    <span class="number">33.33</span> <span class="params">| Using where; Using temporary; Using filesort |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br></pre></td></tr></table></figure>

<h5 id="4、Using-filesort"><a href="#4、Using-filesort" class="headerlink" title="4、Using filesort"></a>4、Using filesort</h5><p><code>Using filesort</code>：表示无法利用索引完成的排序操作，也就是<code>ORDER BY</code>的字段没有索引，通常这样的SQL都是需要优化的。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT one_id from one  ORDER BY create_time;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra          <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> one   <span class="params">| NULL       |</span> ALL  <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    3 |</span>      <span class="number">100</span> <span class="params">| Using filesort |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+</span><br></pre></td></tr></table></figure>

<p>如果<code>ORDER BY</code>字段有索引就会用到覆盖索引，相比执行速度快很多。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT one_id from one  ORDER BY one_id;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type  |</span> possible_keys <span class="params">| key     |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra       <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> one   <span class="params">| NULL       |</span> index <span class="params">| NULL          |</span> PRIMARY <span class="params">| 4       |</span> NULL <span class="params">|    3 |</span>      <span class="number">100</span> <span class="params">| Using index |</span></span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br></pre></td></tr></table></figure>

<h5 id="5、Using-join-buffer"><a href="#5、Using-join-buffer" class="headerlink" title="5、Using join buffer"></a>5、Using join buffer</h5><p><code>Using join buffer</code>：在我们联表查询的时候，如果表的连接条件没有用到索引，需要有一个连接缓冲区来存储中间结果。</p>
<p>先看一下有索引的情况：连接条件 <code>one_name</code> 、<code>two_name</code> 都用到索引。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT one_name from one o,two t where o.one_name = t.two_name;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+----------+---------+----------------------+------+----------+--------------------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type  |</span> possible_keys <span class="params">| key      |</span> key_len <span class="params">| ref                  |</span> rows <span class="params">| filtered |</span> Extra                    <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+-------+---------------+----------+---------+----------------------+------+----------+--------------------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> o     <span class="params">| NULL       |</span> index <span class="params">| idx_name      |</span> idx_name <span class="params">| 768     |</span> NULL                 <span class="params">|    3 |</span>      <span class="number">100</span> <span class="params">| Using where; Using index |</span></span><br><span class="line"><span class="params">|  1 |</span> SIMPLE      <span class="params">| t     |</span> NULL       <span class="params">| ref   |</span> idx_name      <span class="params">| idx_name |</span> <span class="number">768</span>     <span class="params">| xin-slave.o.one_name |</span>    <span class="number">1</span> <span class="params">|      100 |</span> Using index              <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+-------+---------------+----------+---------+----------------------+------+----------+--------------------------+</span></span><br></pre></td></tr></table></figure>

<p>接下来删掉 连接条件 <code>one_name</code> 、<code>two_name</code> 的字段索引。发现<code>Extra</code> 列变成 <code>Using join buffer</code>，<code>type</code>均为全表扫描，这也是<code>SQL</code>优化中需要注意的地方。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT one_name from one o,two t where o.one_name = t.two_name;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------------------------------------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra                                              <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------------------------------------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> t     <span class="params">| NULL       |</span> ALL  <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">|    2 |</span>      <span class="number">100</span> <span class="params">| NULL                                               |</span></span><br><span class="line"><span class="params">|  1 |</span> SIMPLE      <span class="params">| o     |</span> NULL       <span class="params">| ALL  |</span> NULL          <span class="params">| NULL |</span> NULL    <span class="params">| NULL |</span>    <span class="number">3</span> <span class="params">|    33.33 |</span> Using where; Using join buffer (Block Nested Loop) <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------------------------------------------+</span></span><br></pre></td></tr></table></figure>

<h5 id="6、Impossible-where"><a href="#6、Impossible-where" class="headerlink" title="6、Impossible where"></a>6、Impossible where</h5><p><code>Impossible where</code>：表示在我们用不太正确的<code>where</code>语句，导致没有符合条件的行。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT one_name from one WHERE <span class="number">1</span>=<span class="number">2</span>;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+------------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra            <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+------------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> NULL  <span class="params">| NULL       |</span> NULL <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">| NULL |</span> NULL     <span class="params">| Impossible WHERE |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+------------------+</span><br></pre></td></tr></table></figure>

<h5 id="7、No-tables-used"><a href="#7、No-tables-used" class="headerlink" title="7、No tables used"></a>7、No tables used</h5><p><code>No tables used</code>：我们的查询语句中没有<code>FROM</code>子句，或者有 <code>FROM DUAL</code>子句。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN select now();</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+</span><br><span class="line"><span class="params">| id |</span> select_type <span class="params">| table |</span> partitions <span class="params">| type |</span> possible_keys <span class="params">| key  |</span> key_len <span class="params">| ref  |</span> rows <span class="params">| filtered |</span> Extra          <span class="params">|</span></span><br><span class="line"><span class="params">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+</span></span><br><span class="line"><span class="params">|</span>  <span class="number">1</span> <span class="params">| SIMPLE      |</span> NULL  <span class="params">| NULL       |</span> NULL <span class="params">| NULL          |</span> NULL <span class="params">| NULL    |</span> NULL <span class="params">| NULL |</span> NULL     <span class="params">| No tables used |</span></span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+</span><br></pre></td></tr></table></figure>

<p><code>Extra</code>列的信息非常非常多，这里就不再一一列举了，详见 <code>MySQL</code>官方文档 ：[<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/explain-output.html#jointype_index_merge">https://dev.mysql.com/doc/refman/5.7/en/explain-output.html#jointype_index_merge</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Yasir</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2020/11/13/Explain%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/">http://example.com/2020/11/13/Explain%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Yasir'S Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2019/11/10/egVhFWopA5mP2Hk.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2020/11/13/%E5%85%B3%E4%BA%8Eif%20else%E5%86%99%E6%B3%95%E5%BB%BA%E8%AE%AE/"><img class="prev-cover" src="https://i.loli.net/2019/11/10/71wgohfPHqXRbG9.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">关于if else写法建议</div></div></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://i.loli.net/2020/11/04/NOYMJbKtxVSUy5T.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Yasir</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">27</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Yasir-yan"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Explain%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92"><span class="toc-number">1.</span> <span class="toc-text">Explain执行计划</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Explain%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8"><span class="toc-number">1.1.</span> <span class="toc-text">1.Explain有什么用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Explain%E6%9C%89%E5%93%AA%E4%BA%9B%E4%BF%A1%E6%81%AF"><span class="toc-number">1.2.</span> <span class="toc-text">2.Explain有哪些信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Explain%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.3.</span> <span class="toc-text">3.Explain执行计划详解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-id"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 id</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81id%E7%9B%B8%E5%90%8C"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">1、id相同</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81id%E4%B8%8D%E5%90%8C"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">2、id不同</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E4%BB%A5%E4%B8%8A%E4%B8%A4%E7%A7%8D%E5%90%8C%E6%97%B6%E5%AD%98%E5%9C%A8"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">3、以上两种同时存在</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2select-type"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2select_type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81SIMPLE"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">1、SIMPLE</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81PRIMARY"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">2、PRIMARY</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81SUBQUERY"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">3、SUBQUERY</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81DERIVED"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">4、DERIVED</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81UNION"><span class="toc-number">1.3.2.5.</span> <span class="toc-text">5、UNION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81UNION-RESULT"><span class="toc-number">1.3.2.6.</span> <span class="toc-text">6、UNION RESULT</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3table"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3table</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4partitions"><span class="toc-number">1.3.4.</span> <span class="toc-text">3.4partitions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5type"><span class="toc-number">1.3.5.</span> <span class="toc-text">3.5type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81system"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">1、system</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81const"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">2、const</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81eq-ref"><span class="toc-number">1.3.5.3.</span> <span class="toc-text">3、eq_ref</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81ref"><span class="toc-number">1.3.5.4.</span> <span class="toc-text">4、ref</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81ref-or-null"><span class="toc-number">1.3.5.5.</span> <span class="toc-text">5、ref_or_null</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81index-merge"><span class="toc-number">1.3.5.6.</span> <span class="toc-text">6、index_merge</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7%E3%80%81unique-subquery"><span class="toc-number">1.3.5.7.</span> <span class="toc-text">7、unique_subquery</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8%E3%80%81index-subquery"><span class="toc-number">1.3.5.8.</span> <span class="toc-text">8、index_subquery</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9%E3%80%81range"><span class="toc-number">1.3.5.9.</span> <span class="toc-text">9、range</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#10%E3%80%81index"><span class="toc-number">1.3.5.10.</span> <span class="toc-text">10、index</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11%E3%80%81ALL"><span class="toc-number">1.3.5.11.</span> <span class="toc-text">11、ALL</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6possible-keys"><span class="toc-number">1.3.6.</span> <span class="toc-text">3.6possible_keys</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7key"><span class="toc-number">1.3.7.</span> <span class="toc-text">3.7key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8key-len"><span class="toc-number">1.3.8.</span> <span class="toc-text">3.8key_len</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9ref"><span class="toc-number">1.3.9.</span> <span class="toc-text">3.9ref</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-10rows"><span class="toc-number">1.3.10.</span> <span class="toc-text">3.10rows</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-11filtered"><span class="toc-number">1.3.11.</span> <span class="toc-text">3.11filtered</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-12Extra"><span class="toc-number">1.3.12.</span> <span class="toc-text">3.12Extra</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81Using-index"><span class="toc-number">1.3.12.1.</span> <span class="toc-text">1、Using index</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81Using-where"><span class="toc-number">1.3.12.2.</span> <span class="toc-text">2、Using where</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81Using-temporary"><span class="toc-number">1.3.12.3.</span> <span class="toc-text">3、Using temporary</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81Using-filesort"><span class="toc-number">1.3.12.4.</span> <span class="toc-text">4、Using filesort</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81Using-join-buffer"><span class="toc-number">1.3.12.5.</span> <span class="toc-text">5、Using join buffer</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81Impossible-where"><span class="toc-number">1.3.12.6.</span> <span class="toc-text">6、Impossible where</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7%E3%80%81No-tables-used"><span class="toc-number">1.3.12.7.</span> <span class="toc-text">7、No tables used</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/01/20/DB%E6%AD%BB%E9%94%81%E6%8E%92%E6%9F%A5%E5%88%86%E6%9E%90%E4%B8%8E%E6%80%9D%E8%80%83/" title="DB死锁排查分析与思考"><img src="https://i.loli.net/2019/11/10/rJbFpE65tmxPv7R.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DB死锁排查分析与思考"/></a><div class="content"><a class="title" href="/2021/01/20/DB%E6%AD%BB%E9%94%81%E6%8E%92%E6%9F%A5%E5%88%86%E6%9E%90%E4%B8%8E%E6%80%9D%E8%80%83/" title="DB死锁排查分析与思考">DB死锁排查分析与思考</a><time datetime="2021-01-20T05:09:46.000Z" title="发表于 2021-01-20 13:09:46">2021-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/01/19/4.InnoDB%E5%BC%95%E6%93%8E%E4%B9%8B-%E5%BC%82%E6%AD%A5IO%EF%BC%88Async%20IO%EF%BC%89/" title="InnoDB引擎之-异步IO（Async IO）"><img src="https://i.loli.net/2019/11/10/T7Mu8Aod3egmC4Q.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="InnoDB引擎之-异步IO（Async IO）"/></a><div class="content"><a class="title" href="/2021/01/19/4.InnoDB%E5%BC%95%E6%93%8E%E4%B9%8B-%E5%BC%82%E6%AD%A5IO%EF%BC%88Async%20IO%EF%BC%89/" title="InnoDB引擎之-异步IO（Async IO）">InnoDB引擎之-异步IO（Async IO）</a><time datetime="2021-01-19T07:53:46.000Z" title="发表于 2021-01-19 15:53:46">2021-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/11/oh%20my%20zsh%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE(%E5%9B%BD%E5%86%85%E5%8F%AF%E7%94%A8)/" title="oh my zsh安装配置(国内可用)"><img src="https://i.loli.net/2019/11/10/egVhFWopA5mP2Hk.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="oh my zsh安装配置(国内可用)"/></a><div class="content"><a class="title" href="/2020/12/11/oh%20my%20zsh%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE(%E5%9B%BD%E5%86%85%E5%8F%AF%E7%94%A8)/" title="oh my zsh安装配置(国内可用)">oh my zsh安装配置(国内可用)</a><time datetime="2020-12-11T03:09:46.000Z" title="发表于 2020-12-11 11:09:46">2020-12-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/11/Git%E4%BF%9D%E5%AD%98%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81/" title="Ubuntu保存git用户名和密码"><img src="https://i.loli.net/2019/11/10/71wgohfPHqXRbG9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ubuntu保存git用户名和密码"/></a><div class="content"><a class="title" href="/2020/12/11/Git%E4%BF%9D%E5%AD%98%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81/" title="Ubuntu保存git用户名和密码">Ubuntu保存git用户名和密码</a><time datetime="2020-12-11T03:09:46.000Z" title="发表于 2020-12-11 11:09:46">2020-12-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/11/Ubuntu%20%E6%B7%BB%E5%8A%A0%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8/" title="Ubuntu添加开机启动"><img src="https://i.loli.net/2019/11/10/xthHmnbdNerWOqP.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ubuntu添加开机启动"/></a><div class="content"><a class="title" href="/2020/12/11/Ubuntu%20%E6%B7%BB%E5%8A%A0%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8/" title="Ubuntu添加开机启动">Ubuntu添加开机启动</a><time datetime="2020-12-11T03:09:46.000Z" title="发表于 2020-12-11 11:09:46">2020-12-11</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>